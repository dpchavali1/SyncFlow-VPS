<?xml version="1.0" encoding="utf-8"?>
<!--
    Data Extraction Rules for Android 12+ (API 31+)
    Controls what data can be transferred during device-to-device transfers
-->
<data-extraction-rules>
    <cloud-backup>
        <!-- Backup ONLY recovery code data (for account recovery on reinstall) -->
        <!-- User can opt-out via Settings > Backup & Restore > Google Drive Backup -->
        <include domain="sharedpref" path="syncflow_recovery.xml" />

        <!-- Exclude the local-only recovery storage (used when backup is disabled) -->
        <exclude domain="sharedpref" path="syncflow_recovery_local.xml" />

        <!-- Exclude all other sensitive data from cloud backup -->
        <exclude domain="sharedpref" path="syncflow_prefs.xml" />
        <exclude domain="sharedpref" path="e2ee_prefs.xml" />
        <exclude domain="database" path="." />
        <exclude domain="file" path="." />
    </cloud-backup>

    <device-transfer>
        <!-- Allow preferences transfer during device migration -->
        <include domain="sharedpref" path="syncflow_prefs.xml" />
        <include domain="sharedpref" path="syncflow_recovery.xml" />
        <!-- Local-only recovery is also transferred for device-to-device (not cloud backup) -->
        <include domain="sharedpref" path="syncflow_recovery_local.xml" />
        <!-- Databases are excluded by default (not included) -->
    </device-transfer>
</data-extraction-rules>